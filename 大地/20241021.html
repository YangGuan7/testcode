<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>20241021開完會修改</title>
    <style>
      .main {
        height: 300px;
        overflow-y: auto; /* 垂直滾動條 */
      }
      table {
        width: 100%;
        border-collapse: collapse;
        margin: 0 auto;
      }
      .rvfrom {
        width: 1180px;
        margin: 0 auto;
        height: 400px; /* 固定高度 */
        position: relative;
      }
      th {
        background-color: #228dbf;
        position: sticky;
        top: 0;
        z-index: 1;
      }
      td {
        vertical-align: middle;
        text-align: center;
      }
      .scrollable-td {
        height: 200px;
        overflow-y: scroll;
      }
      .rv-overflow {
        /* max-height: 200px; */
        overflow-y: auto;
        line-height: 1.5;
        margin: 5px 0px 5px 5px;
        padding: 5px;
      }
    </style>
  </head>
  <body>
    <div class="main">
      <table
        class="rvfrom AutoNewLine"
        cellspacing="0"
        rules="all"
        border="1"
        id="GVReViewList"
        style="border-collapse: collapse"
      >
        <tbody>
          <tr>
            <th scope="col">序號</th>
            <th scope="col">身分</th>
            <th scope="col">人員姓名</th>
            <th scope="col">審查意見摘要</th>
            <th scope="col">存檔日期</th>
            <th scope="col" style="min-width: 110px">&nbsp;</th>
          </tr>
          <tr>
            <td>1</td>
            <td>審查委員</td>
            <td>陳曉明</td>
            <td>
              本市水土保持計畫請審查委員及承辦技師加強檢視事項
              本處僅就審查常見缺失提示審查委員會及承辦技師加強確認，不實質參與審查，請審查委員秉專業依水土保持計畫審核監督辦法、水土保持技術規範及臺北市水土保持申請參考手冊妥為審查。
              1. 基本資料是否完備。 1.1 雨量站選定是否合理。 1.2
              提供鑽探資料上傳地調所之佐證。 1.3
              評估地質適宜性、災害潛勢，並作具體結論。 1.4
              開發基地無座落地質敏感區或已檢附基地地質調查及地質安全評估。
              2.開挖整地是否符合規定。 2.1 開挖避免截斷斷層、破碎帶及順向坡。
              2.2
              是否力求挖填平衡首次建案挖方＜計畫面積x15,000m3/ha(或首次農業使用挖方＜計畫面積x7,500m3/ha)。
              本市水土保持計畫請審查委員及承辦技師加強檢視事項
              本處僅就審查常見缺失提示審查委員會及承辦技師加強確認，不實質參與審查，請審查委員秉專業依水土保持計畫審核監督辦法、水土保持技術規範及臺北市水土保持申請參考手冊妥為審查。
              1. 基本資料是否完備。 1.1 雨量站選定是否合理。 1.2
              提供鑽探資料上傳地調所之佐證。 1.3
              評估地質適宜性、災害潛勢，並作具體結論。 1.4
              開發基地無座落地質敏感區或已檢附基地地質調查及地質安全評估。
              2.開挖整地是否符合規定。 2.1 開挖避免截斷斷層、破碎帶及順向坡。
              2.2
              是否力求挖填平衡首次建案挖方＜計畫面積x15,000m3/ha(或首次農業使用挖方＜計畫面積x7,500m3/ha)。
              本市水土保持計畫請審查委員及承辦技師加強檢視事項
              本處僅就審查常見缺失提示審查委員會及承辦技師加強確認，不實質參與審查，請審查委員秉專業依水土保持計畫審核監督辦法、水土保持技術規範及臺北市水土保持申請參考手冊妥為審查。
              1. 基本資料是否完備。 1.1 雨量站選定是否合理。 1.2
              提供鑽探資料上傳地調所之佐證。 1.3
              評估地質適宜性、災害潛勢，並作具體結論。 1.4
              開發基地無座落地質敏感區或已檢附基地地質調查及地質安全評估。
              2.開挖整地是否符合規定。 2.1 開挖避免截斷斷層、破碎帶及順向坡。
              2.2
              是否力求挖填平衡首次建案挖方＜計畫面積x15,000m3/ha(或首次農業使用挖方＜計畫面積x7,500m3/ha)。
              本市水土保持計畫請審查委員及承辦技師加強檢視事項
              本處僅就審查常見缺失提示審查委員會及承辦技師加強確認，不實質參與審查，請審查委員秉專業依水土保持計畫審核監督辦法、水土保持技術規範及臺北市水土保持申請參考手冊妥為審查。
              1. 基本資料是否完備。 1.1 雨量站選定是否合理。 1.2
              提供鑽探資料上傳地調所之佐證。 1.3
              評估地質適宜性、災害潛勢，並作具體結論。 1.4
              開發基地無座落地質敏感區或已檢附基地地質調查及地質安全評估。
              2.開挖整地是否符合規定。 2.1 開挖避免截斷斷層、破碎帶及順向坡。
              2.2
              是否力求挖填平衡首次建案挖方＜計畫面積x15,000m3/ha(或首次農業使用挖方＜計畫面積x7,500m3/ha)。
            </td>
            <td>2024-10-17 14:56</td>
            <td>
              <input
                type="submit"
                name="GVReViewList$ctl02$ctl00"
                value="編輯"
              />
              <input
                type="submit"
                name="GVReViewList$ctl02$ctl01"
                value="刪除"
                onclick="return confirm('請確認刪除這筆資料?');"
              />
            </td>
          </tr>

          <tr>
            <td>2</td>
            <td>主管機關</td>
            <td>張朝和</td>
            <td>
              本市水土保持計畫請審查委員及承辦技師加強檢視事項本市水土保持計畫請審查委員及承辦技師加強檢視事項本市水土保持計畫請審查委員及承辦技師加強檢視事項本市水土保持計畫請審查委員及承辦技師加強檢視事項本市水土保持計畫請審查委員及承辦技師加強檢視事項本市水土保持計畫請審查委員及承辦技師加強檢視事項本市水土保持計畫請審查委員及承辦技師加強檢視事項本市水土保持計畫請審查委員及承辦技師加強檢視事項
            </td>
            <td>2024-10-21 16:11</td>
            <td>
              <input
                type="submit"
                name="GVReViewList$ctl02$ctl00"
                value="編輯"
              />
              <input
                type="submit"
                name="GVReViewList$ctl02$ctl01"
                value="刪除"
                onclick="return confirm('請確認刪除這筆資料?');"
              />
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // 第一部分：處理 rv-scrollbar 和 rv-tittle
        const rvScrollbars = document.querySelectorAll("td.rv-scrollbar");

        rvScrollbars.forEach(function (td) {
          const divs = td.querySelectorAll("div");
          if (divs.length > 0) {
            const lastDiv = divs[divs.length - 1];
            lastDiv.classList.add("rv-divScrollbar");

            if (lastDiv.innerHTML.trim() === "") {
              lastDiv.style.display = "none";
              const rvTittle = document.querySelector(".rv-tittle");
              if (rvTittle) {
                rvTittle.style.display = "none";
              }
            } else {
              lastDiv.style.display = "";
              const rvTittle = document.querySelector(".rv-tittle");
              if (rvTittle) {
                rvTittle.style.display = "";
              }
            }
          }
        });

        // 第二部分：處理 rvfrom 表格
        const table = document.querySelector("table.rvfrom");

        if (table) {
          const tbody = table.querySelector("tbody");

          if (tbody) {
            const rows = tbody.querySelectorAll("tr");

            if (rows.length > 0) {
              const lastRow = rows[rows.length - 1];
              const lastTd = lastRow.querySelector("td:last-child");

              if (lastTd) {
                lastTd.style.borderBottom = "none";
              }
            }
          }
        }
      });
    </script>
    <script>
      // 當 DOM 完全加載後執行此函數
      document.addEventListener("DOMContentLoaded", function () {
        // 獲取表格元素
        const table = document.getElementById("GVReViewList");

        // 獲取表格的第一行（表頭）
        const headerRow = table.querySelector("tr:first-child");
        // 獲取表頭中的所有 <th> 元素
        const headerCells = headerRow.querySelectorAll("th");
        // 如果表頭中有至少 4 個 <th> 元素，移除第四個 <th>
        if (headerCells.length >= 4) {
          headerCells[3].remove();
        }

        // 獲取表格中除表頭外的所有行
        const rows = table.querySelectorAll("tr:not(:first-child)");
        // 遍歷每一行
        rows.forEach((row, index) => {
          // 獲取當前行中的所有 <td> 元素
          const cells = row.querySelectorAll("td");
          // 如果當前行中有至少 4 個 <td> 元素
          if (cells.length >= 4) {
            // 獲取第四個 <td> 元素
            const fourthCell = cells[3];
            // 創建一個新的行元素
            const newRow = document.createElement("tr");
            // 創建一個新的單元格元素
            const newCell = document.createElement("td");
            // 設置新的單元格的 colspan 屬性，使其跨越多個列
            newCell.colSpan = cells.length - 2;

            // 將第四個 <td> 的內容分割並在句號處換行
            const content = fourthCell.textContent.split("。").join("。<br>");
            // 創建一個新的 div 元素來包裹內容
            const contentDiv = document.createElement("div");
            // 將處理過的內容設置為 div 的內部 HTML
            contentDiv.innerHTML = content;
            // 為 div 添加 CSS 類別 "rv-overflow"
            contentDiv.classList.add("rv-overflow");

            // 將 div 添加到新的單元格中
            newCell.appendChild(contentDiv);

            // 設置新的單元格的文本對齊方式為左對齊
            newCell.style.textAlign = "start";
            // 將新的單元格添加到新的行中
            newRow.appendChild(newCell);
            // 將新的行插入到當前行的後面
            row.parentNode.insertBefore(newRow, row.nextSibling);
            // 移除原本的第四個 <td> 元素
            fourthCell.remove();

            // 設置最後一個 <td> 的 rowspan 屬性，使其跨越兩行
            const lastCell = cells[cells.length - 1];
            lastCell.rowSpan = 2;

            // 設置行的背景顏色，根據行的索引來交替顏色
            const color = index % 2 === 0 ? "#e3eef9" : "#ffffff";
            row.style.backgroundColor = color;
            newRow.style.backgroundColor = color;
          }
        });
      });
    </script>

    <script></script>
  </body>
</html>
